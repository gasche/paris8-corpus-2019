let rec count_moves = function
  ...

let rec end_point start moves =
  ...

let rec points start moves =
  ...
